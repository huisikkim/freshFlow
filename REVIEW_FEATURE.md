# 리뷰 및 평점 시스템 구현 완료

## 구현된 기능

### 1. 가게사장님 기능 (유통업자 평가)
- **리뷰 작성 화면** (`create_store_review_page.dart`)
  - 배송 완료 후 주문 상세에서 접근
  - 전체 평점 (1-5 별점)
  - 세부 평점
    - 배송 품질
    - 상품 품질
    - 서비스 품질
  - 리뷰 내용 (최소 10자)
  
- **API 호출**
  - `POST /api/reviews/store` - 리뷰 작성
  - `GET /api/reviews/statistics` - 통계 조회

### 2. 유통업자 기능 (가게사장님 평가)
- **리뷰 작성 화면** (`create_distributor_review_page.dart`)
  - 배송 완료 후 주문 상세에서 접근
  - 전체 평점 (1-5 별점)
  - 세부 평점
    - 결제 신뢰도
    - 소통 품질
    - 주문 정확도
  - 리뷰 내용 (최소 10자)
  
- **API 호출**
  - `POST /api/reviews/distributor` - 리뷰 작성
  - `GET /api/reviews/statistics` - 통계 조회

## 파일 구조

```
lib/
├── domain/entities/
│   └── review.dart                              # 리뷰 엔티티
├── data/
│   ├── models/
│   │   └── review_model.dart                    # 리뷰 모델
│   └── datasources/
│       └── review_remote_datasource.dart        # 리뷰 API 데이터소스
├── presentation/
│   ├── providers/
│   │   └── review_provider.dart                 # 리뷰 상태 관리
│   └── pages/
│       ├── create_store_review_page.dart        # 가게사장님 리뷰 작성
│       ├── create_distributor_review_page.dart  # 유통업자 리뷰 작성
│       └── order_detail_page.dart               # 주문 상세 (수정)
└── core/constants/
    └── api_constants.dart                       # API 엔드포인트 추가
```

## 사용 방법

### 가게사장님
1. 주문 내역에서 "배송완료" 상태의 주문 확인
   - 리뷰 작성 가능: 노란색 "리뷰 작성 가능" 배지 표시
   - 리뷰 작성 완료: 초록색 "리뷰 등록 완료" 배지 표시
2. 주문 상세 페이지로 이동
3. "리뷰 작성하기" 버튼 클릭 (이미 작성한 경우 버튼 대신 완료 메시지 표시)
4. 전체 평점 및 세부 평점 입력
   - 배송 품질
   - 상품 품질
   - 서비스 품질
5. 리뷰 내용 작성 (최소 10자)
6. "리뷰 작성 완료" 버튼 클릭
7. 리뷰 작성 후 자동으로 주문 목록으로 이동

### 유통업자
1. 받은 주문에서 "배송완료" 상태의 주문 확인
   - 리뷰 작성 가능: 노란색 "리뷰 작성 가능" 배지 표시
   - 리뷰 작성 완료: 초록색 "리뷰 등록 완료" 배지 표시
2. 주문 상세 페이지로 이동
3. "리뷰 작성하기" 버튼 클릭 (이미 작성한 경우 버튼 대신 완료 메시지 표시)
4. 전체 평점 및 세부 평점 입력
   - 결제 신뢰도
   - 소통 품질
   - 주문 정확도
5. 리뷰 내용 작성 (최소 10자)
6. "리뷰 작성 완료" 버튼 클릭
7. 리뷰 작성 후 자동으로 주문 목록으로 이동

## 리뷰 제약사항
- ✅ 배송 완료 후에만 작성 가능
- ✅ 한 주문당 한 번만 작성 가능
  - **서버에서 검증** (중복 작성 시 에러 반환)
  - **클라이언트에서 사전 확인** (`hasStoreReview`, `hasDistributorReview` 필드)
  - 리뷰 작성 페이지 진입 전 최신 주문 정보 확인
  - 이미 작성된 경우 "이미 리뷰를 작성한 주문입니다" 메시지 표시
- ✅ 평점은 1-5 사이
- ✅ 리뷰 내용은 최소 10자 이상
- ✅ 리뷰 작성 완료 후 "리뷰 등록 완료" 상태 표시
- ✅ 중복 작성 시도 시 자동으로 주문 목록 새로고침

## 백엔드 API 연동
주문 조회 API 응답에 리뷰 작성 여부 필드 포함:
```json
{
  "id": 123,
  "orderNumber": "ORD-20251127-155507-742",
  "status": "DELIVERED",
  "hasStoreReview": true,        // 가게사장님 리뷰 작성 여부
  "hasDistributorReview": false  // 유통업자 리뷰 작성 여부
}
```

## 리뷰 프로세스 흐름

```
주문 생성
    ↓
배송 시작
    ↓
배송 완료 (DELIVERED)
    ↓
[양측] 주문 목록에 "리뷰 작성 가능" 배지 표시
    ↓
[주문 상세] "리뷰 작성하기" 버튼 표시
    ↓
[가게사장님] 유통업자 평가 (배송/상품/서비스)
[유통업자] 가게사장님 평가 (결제/소통/주문정확도)
    ↓
리뷰 작성 완료
    ↓
[주문 목록] "리뷰 등록 완료" 배지로 변경
[주문 상세] "리뷰 등록 완료" 메시지 표시
```

## 다음 단계 (선택사항)
- 받은 리뷰 목록 화면
- 작성한 리뷰 목록 화면
- 리뷰 통계 대시보드
- 프로필에 평점 배지 표시
- 리뷰 수정/삭제 기능
- 리뷰 신고 기능
